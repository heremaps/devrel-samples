{"version":3,"file":"deprecated.js","sourceRoot":"","sources":["../src/deprecated.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable prefer-destructuring, no-shadow,  no-param-reassign, @typescript-eslint/ban-types, no-redeclare, func-names, @typescript-eslint/no-explicit-any, prefer-rest-params, @typescript-eslint/no-non-null-assertion */\n\ninterface HashSet {\n  [key: string]: boolean;\n}\n\nexport interface Warner {\n  (): void;\n}\n\nfunction createWarner(\n  type: string,\n  name: string,\n  alternative?: string,\n  version?: string,\n  url?: string\n): Warner {\n  const warnedPositions: HashSet = {};\n\n  return () => {\n    const stack: string = (<any>new Error()).stack || '';\n    let at = (stack.match(/(?:\\s+at\\s.+){2}\\s+at\\s(.+)/) || [undefined, ''])[1];\n    if (at) {\n      if (/\\)$/.test(at)) {\n        at = at.match(/[^(]+(?=\\)$)/)![0];\n      } else {\n        at = at.trim();\n      }\n\n      if (at in warnedPositions) {\n        return;\n      }\n      warnedPositions[at] = true;\n    }\n    let message = '';\n\n    // eslint-disable-next-line default-case\n    switch (type) {\n      case 'class':\n        message = 'Component';\n        break;\n      case 'property':\n        message = 'Property';\n        break;\n      case 'method':\n        message = 'Event';\n        break;\n      case 'function':\n        message = 'Function';\n        break;\n    }\n\n    message += ` \\`${name}\\` has been deprecated`;\n\n    if (version) {\n      message += ` since version ${version}`;\n    }\n\n    if (alternative) {\n      message += `, use \\`${alternative}\\` instead`;\n    }\n\n    message += '.';\n\n    if (at) {\n      message += `\\n    at ${at}`;\n    }\n\n    if (url) {\n      message += `\\nCheck out ${url} for more information.`;\n    }\n\n    // eslint-disable-next-line no-console\n    console.warn(message);\n  };\n}\n\nfunction decorateProperty(\n  type: string,\n  name: string,\n  descriptor?: PropertyDescriptor,\n  alternative?: string,\n  version?: string,\n  url?: string\n): PropertyDescriptor {\n  const warner = createWarner(type, name, alternative, version, url);\n\n  descriptor = descriptor || {\n    writable: true,\n    enumerable: false,\n    configurable: true,\n  };\n\n  const deprecatedDescriptor: PropertyDescriptor = {\n    enumerable: descriptor.enumerable,\n    configurable: descriptor.configurable,\n  };\n\n  if (descriptor.get || descriptor.set) {\n    if (descriptor.get) {\n      deprecatedDescriptor.get = function () {\n        warner();\n        return descriptor.get.call(this);\n      };\n    }\n\n    if (descriptor.set) {\n      deprecatedDescriptor.set = function (value) {\n        warner();\n        return descriptor.set.call(this, value);\n      };\n    }\n  } else {\n    let propertyValue = descriptor.value;\n\n    deprecatedDescriptor.get = function () {\n      warner();\n      return propertyValue;\n    };\n\n    if (descriptor.writable) {\n      deprecatedDescriptor.set = function (value) {\n        warner();\n        propertyValue = value;\n      };\n    }\n  }\n\n  return deprecatedDescriptor;\n}\n\nfunction decorateFunction<T extends Function>(\n  type: string,\n  target: T,\n  alternative: string,\n  version: string,\n  url: string\n): T {\n  const {name} = <any>target;\n  const warner = createWarner(type, name, alternative, version, url);\n\n  const fn: T = <any>function () {\n    warner();\n    return target.apply(this, arguments);\n  };\n\n  for (const propertyName of Object.getOwnPropertyNames(target)) {\n    const descriptor = Object.getOwnPropertyDescriptor(target, propertyName);\n\n    if (descriptor.writable) {\n      (<any>fn)[propertyName] = (<any>target)[propertyName];\n    } else if (descriptor.configurable) {\n      Object.defineProperty(fn, propertyName, descriptor);\n    }\n  }\n  return fn;\n}\n\nexport type DeprecatedDecorator = ClassDecorator & PropertyDecorator;\n\nexport interface DeprecatedOptions {\n  alternative?: string;\n  version?: string;\n  url?: string;\n}\n\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param options Object with the properties of `alternative`, `version` and `url`\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated({\n *   alternative: '@here/hds-chip',\n *   version: '1.1.2',\n *   url: 'https://url.to.storybook.here.com'\n * })\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated(options?: DeprecatedOptions): DeprecatedDecorator;\nexport function deprecated<T extends Function>(alternative: string, version: string, fn: T): T;\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param alternative Alternative element (class, property or method) to be used instead\n * @param version Version since when the element is depreacted\n * @param url Link with more information about the component or deprecation\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated('@here/hds-chip', '1.1.2', 'https://url.to.storybook.here.com')\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated(\n  alternative?: string,\n  version?: string,\n  url?: string\n): DeprecatedDecorator;\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param options Object with the properties of `alternative`, `version` and `url`\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated({\n *   alternative: '@here/hds-chip',\n *   version: '1.1.2',\n *   url: 'https://url.to.storybook.here.com'\n * })\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated<T extends Function>(fn: T): T;\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param options Object with the properties of `alternative`, `version` and `url`\n * @param fn Function that is deprecated\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated({\n *   alternative: '@here/hds-chip',\n *   version: '1.1.2',\n *   url: 'https://url.to.storybook.here.com'\n * })\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated<T extends Function>(options: DeprecatedOptions, fn: T): T;\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param alternative Alternative element (class, property or method) to be used instead\n * @param fn Function that is deprecated\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated('@here/hds-chip')\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated<T extends Function>(alternative: string, fn: T): T;\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param alternative Alternative element (class, property or method) to be used instead\n * @param version Version since when the element is deprecated\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated('@here/hds-chip', '1.1.2')\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated<T extends Function>(alternative: string, version: string, fn: T): T;\n/**\n * Decorator to flag a Class, Method, Property or Function as Deprecated\n * It accepts 3 arguments:\n *    - `alternative` A string with the name of the alternative to be used instead\n *    - `version` Since which version is deprecated\n *    - `url` Link to more information\n * @param alternative Alternative element (class, property or method) to be used instead\n * @param version Version since when the element is depreacted\n * @param url Link with more information about the component or deprecation\n * @example\n * ```\n * @customElement('hds-tag')\n * @deprecated('@here/hds-chip', '1.1.2', 'https://url.to.storybook.here.com')\n * export class Tag extends TagBase {\n *   static styles = styles;\n * }\n * ```\n * It logs in the console a message like\n * ```\n * Component `Tag` has been deprecated since version 1.1.2, use `@here/hds-chip` instead.\n * at http://localhost:6006/vendors~main.3ac2f736246dd0305b2f.bundle.js:61967:134\n * Check out https://url.to.storybook.here.com.\n * ```\n */\nexport function deprecated<T extends Function>(\n  alternative: string,\n  version: string,\n  url: string,\n  fn: T\n): T;\nexport function deprecated<T extends {new (...args: any[]): {}}>(...args: any[]): any {\n  let fn = args[args.length - 1];\n\n  if (typeof fn === 'function') {\n    fn = args.pop();\n  } else {\n    fn = undefined;\n  }\n\n  const options = args[0];\n\n  let alternative = '';\n  let version = '';\n  let url = '';\n\n  if (typeof options === 'string') {\n    alternative = options;\n    version = args[1];\n    url = args[2];\n  } else if (options) {\n    ({alternative, version, url} = options);\n  }\n\n  if (fn) {\n    return decorateFunction('function', fn, alternative, version, url);\n  }\n\n  return (\n    target: T,\n    name?: string,\n    descriptor?: PropertyDescriptor\n  ): Function | PropertyDescriptor => {\n    if (typeof name === 'string') {\n      const type = descriptor && typeof descriptor.value === 'function' ? 'method' : 'property';\n      return decorateProperty(type, name, descriptor, alternative, version, url);\n    }\n    if (typeof target === 'function') {\n      const {name} = <any>target;\n      const warner = createWarner('class', name, alternative, version, url);\n\n      return class extends target {\n        constructor(...args: any[]) {\n          warner();\n          super(...args);\n        }\n      };\n    }\n    return target;\n  };\n}\n\nexport default deprecated;\n"]}