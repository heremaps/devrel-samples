{"version":3,"file":"hds-wizard.js","sourceRoot":"","sources":["../src/hds-wizard.ts"],"names":[],"mappings":"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","sourcesContent":["import {customElement, debounce} from '@here/hds-base';\nimport '@here/hds-button';\nimport {Modal, ModalVariant} from '@here/hds-modal';\nimport '@here/hds-overlay';\nimport {Step, Stepper} from '@here/hds-stepper';\nimport {html, nothing, TemplateResult} from 'lit';\nimport {property, query} from 'lit/decorators.js';\nimport {classMap} from 'lit/directives/class-map.js';\nimport {unsafeHTML} from 'lit/directives/unsafe-html.js';\nimport {styles} from './hds-wizard.css.js';\n\nexport type WizardActionPayload = {from: 'confirm' | 'cancel'};\n\n/**\n * @slot header Content to be shown as title on the header\n * @slot body Main content of the modal\n * @slot footer Content to be shown on the footer below the body content\n * @slot stepper Content for the `hds-stepper` element\n * @slot stepper-footer Content for the footer section below the stepper\n *\n * @event {CustomEvent<{from: 'confirm' | 'cancel'}>} action Fired when click on one of the action buttons `WizardActionPayload`\n */\n@customElement('hds-wizard')\nexport class Wizard extends Modal {\n  @property({type: String, reflect: true, attribute: 'stepper-heading'}) stepperHeading = '';\n  @property({type: String, reflect: true, attribute: 'confirm-text'}) confirmText = 'Next';\n  @property({type: String, reflect: true, attribute: 'cancel-text'}) cancelText = 'Back';\n  @property({\n    type: String,\n    reflect: true,\n    attribute: 'step-text',\n  })\n  stepText = 'Step {{ activeStep }} of {{ totalSteps }}';\n  protected debouncedResize = debounce(async () => {\n    await super.changeBodyMaxHeight();\n    await this.changeStepperMaxHeight();\n  }, 150);\n  @query('slot[name=\"stepper\"]') private stepperSlot!: HTMLSlotElement;\n\n  static get styles(): any {\n    return [super.styles, styles];\n  }\n\n  get stepper(): Stepper | undefined {\n    let stepper: Stepper | undefined;\n    const nodes = this.slotNodes(this.stepperSlot)[0]?.childNodes;\n    if (nodes) {\n      stepper = [...nodes].find((element: Node) => element instanceof Stepper) as Stepper;\n    }\n    return stepper;\n  }\n\n  async updated() {\n    await super.updated();\n    if (this.stepper) {\n      this.stepper.orientation = 'vertical';\n    }\n    await super.changeBodyMaxHeight();\n    await this.changeStepperMaxHeight();\n  }\n\n  protected render() {\n    const classes = {\n      dialog: true,\n    };\n\n    return html`\n      <div class=\"-hds-wizard-wrapper -hds-modal-wrapper hds-grid-container ${classMap(classes)}\">\n        <div\n          class=\"hds-wizard-content-wrapper wrapper hds-grid-container\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"title\"\n          aria-describedby=\"content\"\n        >\n          <div class=\"stepper-wrapper\">\n            ${this.renderStepperHeading()}\n            <div class=\"stepper\">\n              <slot name=\"stepper\" @slotchange=\"${this.onSlotChange}\"></slot>\n            </div>\n\n            ${this.renderStepperFooter()}\n          </div>\n          <div class=\"content-wrapper\">\n            ${this.renderContentHeader()}\n            <div\n              class=\"hds-modal-body\"\n              id=\"content\"\n              @scroll=\"${() =>\n                this.dispatchEvent(new CustomEvent('scroll', {composed: true, bubbles: true}))}\"\n            >\n              <slot name=\"body\"></slot>\n              <slot>\n                <div>${this.message}</div>\n              </slot>\n            </div>\n            ${this.renderContentFooter()} ${this.renderCloseButton()}\n          </div>\n        </div>\n        <hds-overlay @click=\"${this.handleClickOverlay}\"></hds-overlay>\n      </div>\n    `;\n  }\n\n  protected async setTabbableElements() {\n    await this.updateComplete;\n    super.setTabbableElements();\n\n    if (this.stepper && this.stepper.nonLinear) {\n      const steps = [...this.stepper.childNodes].filter((node: Node) => node instanceof Step);\n      this.tabbableElements.unshift(...steps);\n    }\n\n    this.removeHandleFocusEvents();\n    this.setTabKeydownListeners();\n  }\n\n  protected renderStepText() {\n    return this.stepText\n      .replace(\n        /{{\\s*activeStep\\s*}}/,\n        `<span id=\"current-step\">${(this.stepper?.activeStep || 0) + 1}</span>`\n      )\n      .replace(/{{\\s*totalSteps\\s*}}/, `${this.stepper?.stepsLength}`);\n  }\n\n  /**\n   * Set calculated max height for stepper as custom css variable\n   */\n  private async changeStepperMaxHeight() {\n    await this.updateComplete;\n    const header = this.shadowRoot!.querySelector('#stepper-heading') as HTMLElement;\n    const footer = this.shadowRoot!.querySelector('#stepper-footer') as HTMLElement;\n    const documentHeight = this.shadowRoot!.ownerDocument.body.offsetHeight;\n\n    const headerHeight = header?.offsetHeight || 0;\n    const footerHeight = footer?.offsetHeight || 0;\n\n    const maxHeight = `${\n      documentHeight - (headerHeight + footerHeight + this.HDS_SPACING_10 * 2)\n    }px`;\n\n    this.shadowRoot!.ownerDocument.body.style.setProperty(\n      '--hds-wizard-stepper-max-height',\n      maxHeight\n    );\n  }\n\n  private renderContentHeader(): unknown {\n    if (this.hideHeader) {\n      return nothing;\n    }\n\n    const classes = {\n      'hds-modal-header': true,\n    };\n\n    const titleClasses = {\n      title: true,\n    };\n\n    if (!this.headerSlotted && !this.headingMessage) {\n      return html` <slot name=\"header\"></slot>`;\n    }\n    return html`\n      <div id=\"modal-header\" class=\"${classMap(classes)}\">\n        <div id=\"title\" class=\"${classMap(titleClasses)}\">\n          <slot name=\"header\">\n            <div class=\"heading-counter\">${unsafeHTML(this.renderStepText())}</div>\n            ${this.headingMessage}\n          </slot>\n        </div>\n      </div>\n    `;\n  }\n\n  private onSlotChange() {\n    const stepsNode = this.slotNodes(this.stepperSlot)[0];\n    const stepper = [...stepsNode.childNodes].filter(\n      (node: Node) => node instanceof Stepper\n    )[0] as Stepper;\n    if (!stepper) {\n      throw new Error('Stepper should be provided');\n    }\n  }\n\n  private renderStepperHeading() {\n    if (this.stepperHeading) {\n      return html` <div id=\"stepper-heading\" class=\"stepper-heading\">${this.stepperHeading}</div>`;\n    }\n    return undefined;\n  }\n\n  private renderStepperFooter() {\n    return html` <div id=\"stepper-footer\" class=\"stepper-footer\">\n      <slot name=\"stepper-footer\"></slot>\n    </div>`;\n  }\n\n  private renderContentFooter() {\n    if (this.hideFooter) {\n      return undefined;\n    }\n    return html`\n      <div id=\"modal-footer\" class=\"hds-modal-footer\">\n        <slot name=\"footer\">${this.renderFooterButtons()}</slot>\n      </div>\n    `;\n  }\n\n  private renderFooterButtons() {\n    const confirm = this.hideConfirm\n      ? undefined\n      : this.renderDefaultFooterButton(this.confirmVariant, this.confirmText, 'confirm');\n    const cancel = this.hideCancel\n      ? undefined\n      : this.renderDefaultFooterButton('secondary', this.cancelText, 'cancel');\n\n    return html` <div class=\"hds-modal-footer--default\">${cancel}${confirm}</div>`;\n  }\n\n  private renderDefaultFooterButton(\n    variant: ModalVariant,\n    text: string,\n    name: 'confirm' | 'cancel'\n  ): TemplateResult {\n    return html` <hds-button\n      class=\"default-button ${name}\"\n      variant=\"${variant}\"\n      width=\"100%\"\n      @click=\"${() => this.defaultButtonClick(name)}\"\n      aria-label=\"${text}\"\n      size=\"small\"\n      >${text}\n    </hds-button>`;\n  }\n\n  private async defaultButtonClick(name: 'confirm' | 'cancel') {\n    await this.updateComplete;\n    this.dispatchEvent(\n      new CustomEvent<WizardActionPayload>('action', {\n        detail: {\n          from: name,\n        },\n      })\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'hds-wizard': Wizard;\n  }\n}\n"]}