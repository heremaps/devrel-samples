{"version":3,"file":"hds-chip-group.js","sourceRoot":"","sources":["../src/hds-chip-group.ts"],"names":[],"mappings":";AAAA,OAAO,EAAC,aAAa,EAAC,MAAM,gBAAgB,CAAC;AAC7C,OAAO,EAAC,IAAI,EAAE,UAAU,EAAC,MAAM,KAAK,CAAC;AACrC,OAAO,EAAC,QAAQ,EAAE,KAAK,EAAC,MAAM,mBAAmB,CAAC;AAClD,OAAO,EAAC,QAAQ,EAAC,MAAM,6BAA6B,CAAC;AACrD,OAAO,EAAC,MAAM,EAAC,MAAM,yBAAyB,CAAC;AAC/C,OAAO,EAAC,IAAI,EAAC,MAAM,eAAe,CAAC;AAG5B,IAAM,SAAS,GAAf,MAAM,SAAU,SAAQ,UAAU;IAAlC;;QAGqB,WAAM,GAAG,QAAQ,CAAC;QAClB,YAAO,GAAG,YAAY,CAAC;QACtB,aAAQ,GAAG,KAAK,CAAC;QAGpC,oBAAe,GAAG,CAAC,CAAC;QACpB,oBAAe,GAAG,CAAC,CAAC;IA+G9B,CAAC;IA7GC,aAAa;QACX,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAED,aAAa,CAAC,CAAa;QACzB,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,OAAO;SACR;QAED,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,IAAI,CAAC,CAAC,MAAM,YAAY,IAAI,EAAE;YACtD,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,MAAc,CAAC;YACxC,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,OAAO,CAAC;YACjC,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,OAAO,CAAC;YACjC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC;SACzC;aAAM,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,IAAI,IAAI,CAAC,eAAe,KAAK,SAAS,EAAE;YACvE,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrC,MAAM,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE,CAAC;YAC1D,MAAM,MAAM,GAAS,IAAI,CAAC,aAA0B,CAAC,WAAW,CAAC;YACjE,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC;YACtD,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC;YACpD,MAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC;YAC3D,MAAM,gBAAgB,GAAG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC;YACzD,MAAM,UAAU,GAAG,CAAC,CAAC,KAAK,GAAG,UAAU,GAAG,gBAAgB,CAAC;YAC3D,MAAM,UAAU,GAAG,CAAC,CAAC,KAAK,GAAG,UAAU,GAAG,gBAAgB,CAAC;YAC3D,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,GAAG,aAAa,UAAU,OAAO,UAAU,KAAK,CAAC;SACtF;aAAM,IAAI,CAAC,CAAC,IAAI,KAAK,SAAS,IAAI,IAAI,CAAC,eAAe,KAAK,SAAS,EAAE;YACrE,IAAI,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE;gBACnC,IAAI,CAAC,eAAe,CAAC,QAAQ;oBAC3B,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,KAAK,EAAE;wBACzC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,QAAQ;wBAC/B,CAAC,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC;aACtC;YAED,MAAM,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC;YACrF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,iBAAiB,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;gBACpD,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,eAAe,IAAI,iBAAiB,CAAC,CAAC,CAAC,YAAY,IAAI,EAAE;oBACzF,MAAM,cAAc,GAAG,iBAAiB,CAAC,CAAC,CAAS,CAAC;oBACpD,MAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;oBAC/C,MAAM,WAAW,GAAG,cAAc,CAAC,KAAK,CAAC;oBACzC,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,WAAW,CAAC;oBACzC,cAAc,CAAC,KAAK,GAAG,WAAW,CAAC;oBACnC,MAAM;iBACP;aACF;SACF;QAED,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,IAAI,CAAC,CAAC,IAAI,KAAK,YAAY,CAAC,IAAI,IAAI,CAAC,eAAe,KAAK,SAAS,EAAE;YAC3F,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,KAAK,CAAC;YACtC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,GAAG,EAAE,CAAC;YAC1C,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC;YACxC,IAAI,CAAC,eAAe,GAAG,SAAS,CAAC;SAClC;IACH,CAAC;IAED,MAAM;QACJ,MAAM,QAAQ,GAAG;YACf,aAAa,EAAE,IAAI,CAAC,MAAM;YAC1B,iBAAiB,EAAE,IAAI,CAAC,OAAO;SAChC,CAAC;QAEF,OAAO,IAAI,CAAA;;uBAEQ,IAAI,CAAC,aAAa;sBACnB,IAAI,CAAC,aAAa;oBACpB,IAAI,CAAC,aAAa;sBAChB,IAAI,CAAC,aAAa;oBACpB,IAAI,CAAC,SAAS;;iBAEjB,QAAQ,CAAC,QAAQ,CAAC;;6BAEN,IAAI,CAAC,aAAa;;KAE1C,CAAC;IACJ,CAAC;IAES,QAAQ;QAChB,OAAO,IAAI,CAAC,WAAW;aACpB,aAAa,CAAC,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC;aAC9B,MAAM,CAAC,CAAC,CAAO,EAAE,EAAE,CAAC,CAAC,YAAY,IAAI,CAAW,CAAC;IACtD,CAAC;IAES,gBAAgB;QACxB,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;YACxC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;SACpB;IACH,CAAC;IAES,SAAS,CAAC,CAAgB;QAClC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,YAAY,IAAI,CAAC,CAAC,GAAG,KAAK,WAAW,CAAC,EAAE;YACtD,OAAO;SACR;QAED,MAAM,iBAAiB,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;QAC3D,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;QAC9B,IAAI,iBAAiB,YAAY,IAAI,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACzD,IAAI,EAAC,KAAK,EAAC,GAAG,iBAAiB,CAAC;YAChC,MAAM,GAAG,GAAG,CAAC,CAAC,GAAG,KAAK,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC5C,KAAK,GAAG,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC;YACrC,KAAK,GAAG,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;YAE7C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;gBACxC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,KAAK,KAAK,EAAE;oBAC5B,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC;oBACjB,MAAM;iBACP;aACF;SACF;IACH,CAAC;;AAtHM,gBAAM,GAAG,MAAM,CAAC;AAChB,2BAAiB,GAAG,EAAC,GAAG,UAAU,CAAC,iBAAiB,EAAE,cAAc,EAAE,IAAI,EAAC,CAAC;AACzD;IAAzB,QAAQ,CAAC,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC;yCAAmB;AAClB;IAAzB,QAAQ,CAAC,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC;0CAAwB;AACtB;IAA1B,QAAQ,CAAC,EAAC,IAAI,EAAE,OAAO,EAAC,CAAC;2CAAkB;AAC7B;IAAd,KAAK,CAAC,MAAM,CAAC;8CAAyC;AAN5C,SAAS;IADrB,aAAa,CAAC,gBAAgB,CAAC;GACnB,SAAS,CAwHrB;SAxHY,SAAS","sourcesContent":["import {customElement} from '@here/hds-base';\nimport {html, LitElement} from 'lit';\nimport {property, query} from 'lit/decorators.js';\nimport {styleMap} from 'lit/directives/style-map.js';\nimport {styles} from './hds-chip-group.css.js';\nimport {Chip} from './hds-chip.js';\n\n@customElement('hds-chip-group')\nexport class ChipGroup extends LitElement {\n  static styles = styles;\n  static shadowRootOptions = {...LitElement.shadowRootOptions, delegatesFocus: true};\n  @property({type: String}) valign = 'center';\n  @property({type: String}) justify = 'flex-start';\n  @property({type: Boolean}) dragging = false;\n  @query('slot') protected slotElement!: HTMLSlotElement;\n  private _draggingSource: Chip | undefined;\n  private _draggingStartX = 0;\n  private _draggingStartY = 0;\n\n  _onSlotChange() {\n    this.updateItemsOrder();\n  }\n\n  _onMouseEvent(e: MouseEvent) {\n    if (!this.dragging) {\n      return;\n    }\n\n    if (e.type === 'mousedown' && e.target instanceof Chip) {\n      this._draggingSource = e.target as Chip;\n      this._draggingStartX = e.clientX;\n      this._draggingStartY = e.clientY;\n      this._draggingSource.style.zIndex = '1';\n    } else if (e.type === 'mousemove' && this._draggingSource !== undefined) {\n      this._draggingSource.dragging = true;\n      const bbox = this._draggingSource.getBoundingClientRect();\n      const window: any = (this.ownerDocument as Document).defaultView;\n      const containerX = bbox.right + (window.scrollX || 0);\n      const containerY = bbox.top + (window.scrollY || 0);\n      const itemMouseOffsetX = this._draggingStartX - bbox.right;\n      const itemMouseOffsetY = this._draggingStartY - bbox.top;\n      const translateX = e.pageX - containerX - itemMouseOffsetX;\n      const translateY = e.pageY - containerY - itemMouseOffsetY;\n      this._draggingSource.style.transform = `translate(${translateX}px, ${translateY}px)`;\n    } else if (e.type === 'mouseup' && this._draggingSource !== undefined) {\n      if (this._draggingSource.selectable) {\n        this._draggingSource.selected =\n          this._draggingSource.style.transform === ''\n            ? this._draggingSource.selected\n            : !this._draggingSource.selected;\n      }\n\n      const elementsFromPoint = this.ownerDocument.elementsFromPoint(e.clientX, e.clientY);\n      for (let i = 0; i < elementsFromPoint.length; i += 1) {\n        if (elementsFromPoint[i] !== this._draggingSource && elementsFromPoint[i] instanceof Chip) {\n          const draggingTarget = elementsFromPoint[i] as Chip;\n          const sourceOrder = this._draggingSource.order;\n          const targetOrder = draggingTarget.order;\n          this._draggingSource.order = targetOrder;\n          draggingTarget.order = sourceOrder;\n          break;\n        }\n      }\n    }\n\n    if ((e.type === 'mouseup' || e.type === 'mouseleave') && this._draggingSource !== undefined) {\n      this._draggingSource.dragging = false;\n      this._draggingSource.style.transform = '';\n      this._draggingSource.style.zIndex = '0';\n      this._draggingSource = undefined;\n    }\n  }\n\n  render() {\n    const stylesEl = {\n      'align-items': this.valign,\n      'justify-content': this.justify,\n    };\n\n    return html`\n      <div\n        @mouseleave=\"${this._onMouseEvent}\"\n        @mousedown=\"${this._onMouseEvent}\"\n        @mouseup=\"${this._onMouseEvent}\"\n        @mousemove=\"${this._onMouseEvent}\"\n        @keydown=\"${this.onKeyDown}\"\n        class=\"-hds-chip-group-wrapper\"\n        style=\"${styleMap(stylesEl)}\"\n      >\n        <slot @slotchange=\"${this._onSlotChange}\"></slot>\n      </div>\n    `;\n  }\n\n  protected getItems() {\n    return this.slotElement\n      .assignedNodes({flatten: true})\n      .filter((e: Node) => e instanceof Chip) as Chip[];\n  }\n\n  protected updateItemsOrder() {\n    const items = this.getItems();\n    for (let i = 0; i < items.length; i += 1) {\n      items[i].order = i;\n    }\n  }\n\n  protected onKeyDown(e: KeyboardEvent) {\n    if (!(e.key === 'ArrowRight' || e.key === 'ArrowLeft')) {\n      return;\n    }\n\n    const currActiveElement = this.ownerDocument.activeElement;\n    const items = this.getItems();\n    if (currActiveElement instanceof Chip && items.length > 0) {\n      let {order} = currActiveElement;\n      const dir = e.key === 'ArrowRight' ? 1 : -1;\n      order = (order + dir) % items.length;\n      order = order < 0 ? items.length - 1 : order;\n\n      for (let i = 0; i < items.length; i += 1) {\n        if (items[i].order === order) {\n          items[i].focus();\n          break;\n        }\n      }\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'hds-chip-group': ChipGroup;\n  }\n}\n"]}