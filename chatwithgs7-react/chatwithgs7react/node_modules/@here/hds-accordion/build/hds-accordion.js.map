{"version":3,"file":"hds-accordion.js","sourceRoot":"","sources":["../src/hds-accordion.ts"],"names":[],"mappings":"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","sourcesContent":["import {customElement} from '@here/hds-base';\nimport {html, LitElement} from 'lit';\nimport {property, query} from 'lit/decorators.js';\nimport {styles} from './hds-accordion.css.js';\nimport {AccordionItem} from './hds-accordion-item.js';\n\nexport type AccordionVariant = 'default' | 'dense' | 'solid';\nexport type AccordionArrowPosition = 'start' | 'end';\nexport type AccordionExpandMode = 'one' | 'many';\nexport type AccordionChangePayload = {index: number; id: string; expanded: boolean};\n\n/**\n * @slot default Slot for `hds-accordion-item` elements\n *\n * @event {CustomEvent<{index: number; id: string; expanded: boolean}>} change Fired when an accordion item has expanded/collapsed `AccordionChangePayload`\n */\n@customElement('hds-accordion')\nexport class Accordion extends LitElement {\n  static styles = styles;\n  static shadowRootOptions = {...LitElement.shadowRootOptions, delegatesFocus: true};\n  @property({type: String, reflect: true}) variant: AccordionVariant = 'default';\n  @property({type: String, reflect: true, attribute: 'arrow-position'})\n  arrowPosition: AccordionArrowPosition = 'end';\n  @property({type: String, reflect: true, attribute: 'expand-mode'})\n  expandMode: AccordionExpandMode = 'many';\n  @property({type: Boolean, reflect: true, attribute: 'default-expanded'}) defaultExpanded = false;\n  @property({type: Boolean, attribute: 'disable-content-padding'}) disableContentPadding = false;\n  @property({type: Boolean, reflect: true}) disabled = false;\n  @query('slot') protected slotElement!: HTMLSlotElement;\n  private _accordionAssignedElementsCache: Element[] = [];\n\n  protected updated() {\n    this._updateAccordionItems();\n  }\n\n  protected render() {\n    return html`\n      <div\n        class=\"-hds-accordion-wrapper\"\n        @keydown=\"${this._onKeyDown}\"\n        @slotchange=\"${this._onSlotChange}\"\n        @change=\"${this._onChange}\"\n      >\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  private _onSlotChange() {\n    this._accordionAssignedElementsCache = this.slotElement.assignedElements();\n\n    if (this.defaultExpanded) {\n      const items = this._getItems();\n      for (let i = 0; i < items.length; i += 1) {\n        if ((this.expandMode === 'one' && i === 0) || this.expandMode === 'many') {\n          items[i].expanded = true;\n        }\n      }\n    }\n    this._updateAccordionItems();\n  }\n\n  private _getFocusedItem() {\n    return this._getItems().find(item => item === document.activeElement);\n  }\n\n  private _focusItemByIndex(index: number) {\n    this._getItems()[index]?.focus();\n  }\n\n  private _onKeyDown(e: KeyboardEvent) {\n    if (['ArrowDown', 'ArrowUp', 'Home', 'End', ' ', 'Enter'].includes(e.key)) {\n      const focusedItem = this._getFocusedItem();\n      const itemsCount = this._getItems().length;\n\n      if (focusedItem !== undefined && itemsCount > 1) {\n        e.preventDefault();\n\n        if (e.key === 'ArrowUp') {\n          this._focusItemByIndex(focusedItem.index === 0 ? itemsCount - 1 : focusedItem.index - 1);\n        } else if (e.key === 'ArrowDown') {\n          this._focusItemByIndex(focusedItem.index === itemsCount - 1 ? 0 : focusedItem.index + 1);\n        } else if (e.key === 'Home') {\n          this._focusItemByIndex(0);\n        } else if (e.key === 'End') {\n          this._focusItemByIndex(itemsCount - 1);\n        } else if (e.key === ' ' || e.key === 'Enter') {\n          focusedItem.expanded = !focusedItem.expanded;\n        }\n      }\n    }\n  }\n\n  private _onChange(e: CustomEvent<AccordionChangePayload>) {\n    if (this.expandMode === 'one' && e.detail.expanded) {\n      this._getItems().forEach(item => {\n        // eslint-disable-next-line no-param-reassign\n        if (item !== e.target) item.expanded = false;\n      });\n    }\n  }\n\n  private _updateAccordionItems() {\n    const items = this._getItems();\n    for (let i = 0; i < items.length; i += 1) {\n      items[i].variant = this.variant;\n      items[i].arrowPosition = this.arrowPosition;\n      items[i].parentDisabled = this.disabled;\n      items[i].index = i;\n      items[i].isFirstChild = i === 0;\n      items[i].isLastChild = i === items.length - 1;\n      items[i].disableContentPadding = this.disableContentPadding;\n    }\n  }\n\n  private _getItems() {\n    return this._accordionAssignedElementsCache.filter(\n      e => e instanceof AccordionItem\n    ) as AccordionItem[];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'hds-accordion': Accordion;\n  }\n}\n"]}